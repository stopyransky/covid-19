import * as file01 from './data/csse_covid_19_data/csse_covid_19_daily_reports/01-22-2020.csv';
import * as file02 from './data/csse_covid_19_data/csse_covid_19_daily_reports/01-23-2020.csv';
import * as file03 from './data/csse_covid_19_data/csse_covid_19_daily_reports/01-24-2020.csv';
import * as file04 from './data/csse_covid_19_data/csse_covid_19_daily_reports/01-25-2020.csv';
import * as file05 from './data/csse_covid_19_data/csse_covid_19_daily_reports/01-26-2020.csv';
import * as file06 from './data/csse_covid_19_data/csse_covid_19_daily_reports/01-27-2020.csv';
import * as file07 from './data/csse_covid_19_data/csse_covid_19_daily_reports/01-28-2020.csv';
import * as file08 from './data/csse_covid_19_data/csse_covid_19_daily_reports/01-29-2020.csv';
import * as file09 from './data/csse_covid_19_data/csse_covid_19_daily_reports/01-30-2020.csv';
import * as file10 from './data/csse_covid_19_data/csse_covid_19_daily_reports/01-31-2020.csv';
import * as file11 from './data/csse_covid_19_data/csse_covid_19_daily_reports/02-01-2020.csv';
import * as file12 from './data/csse_covid_19_data/csse_covid_19_daily_reports/02-02-2020.csv';
import * as file13 from './data/csse_covid_19_data/csse_covid_19_daily_reports/02-03-2020.csv';
import * as file14 from './data/csse_covid_19_data/csse_covid_19_daily_reports/02-04-2020.csv';
import * as file15 from './data/csse_covid_19_data/csse_covid_19_daily_reports/02-05-2020.csv';
import * as file16 from './data/csse_covid_19_data/csse_covid_19_daily_reports/02-06-2020.csv';
import * as file17 from './data/csse_covid_19_data/csse_covid_19_daily_reports/02-07-2020.csv';
import * as file18 from './data/csse_covid_19_data/csse_covid_19_daily_reports/02-08-2020.csv';
import * as file19 from './data/csse_covid_19_data/csse_covid_19_daily_reports/02-09-2020.csv';
import * as file20 from './data/csse_covid_19_data/csse_covid_19_daily_reports/02-10-2020.csv';
import * as file21 from './data/csse_covid_19_data/csse_covid_19_daily_reports/02-11-2020.csv';
import * as file22 from './data/csse_covid_19_data/csse_covid_19_daily_reports/02-12-2020.csv';
import * as file23 from './data/csse_covid_19_data/csse_covid_19_daily_reports/02-13-2020.csv';
import * as file24 from './data/csse_covid_19_data/csse_covid_19_daily_reports/02-14-2020.csv';
import * as file25 from './data/csse_covid_19_data/csse_covid_19_daily_reports/02-15-2020.csv';
import * as file26 from './data/csse_covid_19_data/csse_covid_19_daily_reports/02-16-2020.csv';
import * as file27 from './data/csse_covid_19_data/csse_covid_19_daily_reports/02-17-2020.csv';
import * as file28 from './data/csse_covid_19_data/csse_covid_19_daily_reports/02-18-2020.csv';
import * as file29 from './data/csse_covid_19_data/csse_covid_19_daily_reports/02-19-2020.csv';
import * as file30 from './data/csse_covid_19_data/csse_covid_19_daily_reports/02-20-2020.csv';
import * as file31 from './data/csse_covid_19_data/csse_covid_19_daily_reports/02-21-2020.csv';
import * as file32 from './data/csse_covid_19_data/csse_covid_19_daily_reports/02-22-2020.csv';
import * as file33 from './data/csse_covid_19_data/csse_covid_19_daily_reports/02-23-2020.csv';
import * as file34 from './data/csse_covid_19_data/csse_covid_19_daily_reports/02-24-2020.csv';
import * as file35 from './data/csse_covid_19_data/csse_covid_19_daily_reports/02-25-2020.csv';
import * as file36 from './data/csse_covid_19_data/csse_covid_19_daily_reports/02-26-2020.csv';
import * as file37 from './data/csse_covid_19_data/csse_covid_19_daily_reports/02-27-2020.csv';
import * as file38 from './data/csse_covid_19_data/csse_covid_19_daily_reports/02-28-2020.csv';
import * as file39 from './data/csse_covid_19_data/csse_covid_19_daily_reports/02-29-2020.csv';
import * as file40 from './data/csse_covid_19_data/csse_covid_19_daily_reports/03-01-2020.csv';
import * as file41 from './data/csse_covid_19_data/csse_covid_19_daily_reports/03-01-2020.csv';
import * as file42 from './data/csse_covid_19_data/csse_covid_19_daily_reports/03-02-2020.csv';
import * as file43 from './data/csse_covid_19_data/csse_covid_19_daily_reports/03-03-2020.csv';
import * as file44 from './data/csse_covid_19_data/csse_covid_19_daily_reports/03-04-2020.csv';
import * as file45 from './data/csse_covid_19_data/csse_covid_19_daily_reports/03-05-2020.csv';
import * as file46 from './data/csse_covid_19_data/csse_covid_19_daily_reports/03-06-2020.csv';
import * as file47 from './data/csse_covid_19_data/csse_covid_19_daily_reports/03-07-2020.csv';
import * as file48 from './data/csse_covid_19_data/csse_covid_19_daily_reports/03-08-2020.csv';
import * as file49 from './data/csse_covid_19_data/csse_covid_19_daily_reports/03-09-2020.csv';
import * as file50 from './data/csse_covid_19_data/csse_covid_19_daily_reports/03-10-2020.csv';
import * as file51 from './data/csse_covid_19_data/csse_covid_19_daily_reports/03-11-2020.csv';
import * as file52 from './data/csse_covid_19_data/csse_covid_19_daily_reports/03-12-2020.csv';
import * as file53 from './data/csse_covid_19_data/csse_covid_19_daily_reports/03-13-2020.csv';
import * as file54 from './data/csse_covid_19_data/csse_covid_19_daily_reports/03-14-2020.csv';
import * as file55 from './data/csse_covid_19_data/csse_covid_19_daily_reports/03-15-2020.csv';
import { group, rollup } from 'd3-array';
import * as d3 from 'd3';

const format = d3.timeFormat('%Y-%m-%d');

function stripUnused(obj, prop) {
  const { [prop]: none, ...rest} = obj;
  return rest;
}

function cleanItem(d) {
  let s = stripUnused(d, 'Province/State')
  let sDays = [];

  if(sDays.indexOf(s['Last Update']) >= 0) {
    return null
  }

  s['Last Update'] = format(new Date(s['Last Update']));
  sDays.push(s['Last Update']);

  if(s['Country/Region'] === 'Mainland China') {
    s['Country/Region'] = 'China'
  }

  return s;

}

function dataPrep(src) {
  let data = []
  src.forEach(ss => {

    const item = ss.map(cleanItem);

    if(item) {
      data = [ ...data, ...item];
    }
  });


  const countries = Array.from(new Set(data.map(d => d['Country/Region'])));
  const days = Array.from(new Set(data.map(d => d['Last Update'])));

  const byCountry = group(data, d => d['Country/Region'], d => d['Last Update']);

  const unwrapped = Array.from(byCountry, ([key, value]) => Array.from(value, (v, k) => {
      const arr = v[1];
      return { ...arr[arr.length-1] }
  }));

  console.log('aaaaaaaaa', unwrapped);


  return { raw: data, countries, days, unwrapped };
}


export const files = [
file01,
file02,
file03,
file04,
file05,
file06,
file07,
file08,
file09,
file10,
file11,
file12,
file13,
file14,
file15,
file16,
file17,
file18,
file19,
file20,
file21,
file22,
file23,
file24,
file25,
file26,
file27,
file28,
file29,
file30,
file31,
file32,
file33,
file34,
file35,
file36,
file37,
file38,
file39,
file40,
file41,
file42,
file43,
file44,
file45,
file46,
file47,
file48,
file49,
file50,
file51,
file52,
file53,
file54,
file55,
];

export const dates = [
  '01-22-2020',
  '01-23-2020',
  '01-24-2020',
  '01-25-2020',
  '01-26-2020',
  '01-27-2020',
  '01-28-2020',
  '01-29-2020',
  '01-30-2020',
  '01-31-2020',
  '02-01-2020',
  '02-02-2020',
  '02-03-2020',
  '02-04-2020',
  '02-05-2020',
  '02-06-2020',
  '02-07-2020',
  '02-08-2020',
  '02-09-2020',
  '02-10-2020',
  '02-11-2020',
  '02-12-2020',
  '02-13-2020',
  '02-14-2020',
  '02-15-2020',
  '02-16-2020',
  '02-17-2020',
  '02-18-2020',
  '02-19-2020',
  '02-20-2020',
  '02-21-2020',
  '02-22-2020',
  '02-23-2020',
  '02-24-2020',
  '02-25-2020',
  '02-26-2020',
  '02-27-2020',
  '02-28-2020',
  '02-29-2020',
  '03-01-2020',
  '03-01-2020',
  '03-02-2020',
  '03-03-2020',
  '03-04-2020',
  '03-05-2020',
  '03-06-2020',
  '03-07-2020',
  '03-08-2020',
  '03-09-2020',
  '03-10-2020',
  '03-11-2020',
  '03-12-2020',
  '03-13-2020',
  '03-14-2020',
  '03-15-2020',
  // '03-16-2020',
]




export default {
  files,
  dataPrep
}


